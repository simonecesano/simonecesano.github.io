<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Mac OS X (vers 31 October 2006 - Apple Inc. build 15.17), see www.w3.org" />
  <meta name="viewport" content="width=device-width" />
    <meta charset="utf-8" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>

  <script src="https://code.jquery.com/jquery-3.1.1.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="./spotify-web-api.js" type="text/javascript"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.19.0/URI.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.19.0/URI.fragmentURI.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/URI.js/1.19.0/URI.fragmentQuery.js"></script>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.0.11/handlebars.js"></script>
  <script src="../js/jquery.handlebars.js"></script>
  
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" media="screen" />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Cormorant+Garamond" rel="stylesheet" type="text/css" />
  <link href="https://fonts.googleapis.com/css?family=Proza+Libre" rel="stylesheet" type="text/css" />
  <link href="../font.css" rel="stylesheet" type="text/css" />
  <link href="../movies.css" rel="stylesheet" type="text/css" />
  <title>Albums I added recently</title>
    <script>
    $(function(){
	console.log(document.referrer);
	var s = new SpotifyWebApi();
	var uri = new URI();
	uri.fragmentPrefix("");
	var token = uri.fragment(true).access_token;

	s.setAccessToken(token);

	$('.list').each(function(i, e){
	    var list = $(e);
	    var albums = $(e).html().split(/\n/);
	    albums = _.chain(albums).map(function(e, i){
		e = e.replace(/\s#.+/, '').replace(/^\s*|\s*$/g, '');
		var album_id = (new URI(e)).filename();
		return album_id;
	    }).filter(function(e, i){ return e.length > 0 }).value()

	    Promise.all(_.map(albums, function(e, i){ return s.getAlbums([ e ]) }))
		.then(function(albums){
		    albums = _.map(albums, function(e, i){
			var a = e.albums[0]
			return {
		    	    name: a.name,
		    	    artists: a.artists[0].name,
		    	    image: a.images[1].url,
			    play: a.external_urls.spotify,
			    id: a.id,
		    	    release_date: a.release_date
			};
		    });
		    list.fromTemplate('albums', { albums: albums })
	    })
	})
    })
</script>
    <style>
      .album { display: inline-block; margin: 2em }
    </style>
</head>

<body>
    <div class="container-fluid">
    <div class="row">
      <div class="col-md-9 col-md-offset-1 col-sm-12">
	<h1>Albums I added to spotify</h1>
	<div class="md">
	  <h2>Bucketfull of Brains</h2>
	  I went through a list of recent <a href="http://www.bucketfullofbrains.com/">Bucketfull of
	    Brains</a>
	  covers, and checked out some of the artists I did not know
	</div>
	<div class="list">
	  https://open.spotify.com/album/4XrOBWbnNDKxqvgh5WjlmZ
	  https://open.spotify.com/album/6iY6dGWklw6jfVGhEczCiC
	  https://open.spotify.com/album/7l9NpFno0zbzj2JcEeknIg
	  https://open.spotify.com/album/1HTYaUbM9suWw0DYeFBD8p
	  https://open.spotify.com/album/2negjodS7ksoI1xH61BWva
	</div>
	<div class="md">
	<h2>Paste Magazine's '90s list</h2>
	  I found Paste
	  Magazine's <a href="https://www.pastemagazine.com/blogs/lists/2012/02/the-90-best-albums-of-the-1990s.html">list
	    of the best albums of the '90s</a> and here is what I found. Not everything's included - only what I liked
	  and did not know already.
	</div>
	<div class="list">
	  https://open.spotify.com/album/0wsRyM7gcmbN5l0RiOArGc
	  https://open.spotify.com/album/3jKdxSwYf8UkDhIOIXbwku
	  https://open.spotify.com/album/2mwUmDzFVzwlgibfYH38GR
	  https://open.spotify.com/album/4aHfdntnrglDiXle1SIaUz
	  https://open.spotify.com/album/7t0diHfsasHG5xyLnO4ySl
	  https://open.spotify.com/album/0KacpFBqMd5ZtCbEwyQbnF
	  https://open.spotify.com/album/6c7gEp8KqjMsTmvloivm59
	  https://open.spotify.com/album/5GBPnIYc6qMXwp6n1cW5TT
	  https://open.spotify.com/album/1SV1Fh8rLes7MeTYTXznKd
	  https://open.spotify.com/album/6FOUdn1ZEuJkgfcTt1fQnz
	  https://open.spotify.com/album/0yTmT1i6yHb5EVyJOmIwGw
	  https://open.spotify.com/album/4gy64TkuOWP2Uuu1DuDeZK
	  https://open.spotify.com/album/5DQRAlGAFTpHsXGEg5zw9V
	  https://open.spotify.com/album/1JpaFJzzcsiulO6MdIcQdK
	  https://open.spotify.com/album/5hryhrT7wEdLnZCbJX9F6L
	  https://open.spotify.com/album/0HjEJRTWuP2qkKLlRDH2gg
	</div>
	<div class="md">
	  <h2>Female voices</h2>
	  Stuff my kids hate
	</div>

	<div class="list">
	  https://open.spotify.com/album/4n36X2GMJ84BKh9D9zMRVI
	  https://open.spotify.com/album/1P3B7c85W4mTXHk0fafGw2
	  https://open.spotify.com/album/5sCsfubNchaI9RCpP7K7aB
	  https://open.spotify.com/album/1jWRxIUR3ERw6w4JmP6xCt
	  https://open.spotify.com/album/4KerqbIPBSPn5S2YTKwKys
	  https://open.spotify.com/album/1vz94WpXDVYIEGja8cjFNa
	  https://open.spotify.com/album/55FP2ypQcghszSqylyBRbp
	  https://open.spotify.com/album/2ZAcLWdHBHrdybwws1PVuA
	  https://open.spotify.com/album/3UCpl2Q6HdjHV7LBWswhlx
	  https://open.spotify.com/album/44ylMXOuL1RTKsP3kqWHmw
	  https://open.spotify.com/album/1lZeuZHmv7Mzngg8UEIRPo
	  </pre>
	</div>
      </div>
    </div>
  </div>
    <script id="albums-template" type="text/x-handlebars-template">
    {{#each albums }}
    <div class="album">
      <div id="image" ><img style="height:150px;width:150px;" src="{{ image }}"></div>
      <div id="name">{{ name }}</div><div id="artists">{{ artists }}</div>
      <div id="release_date">{{ release_date }}</div>
      <div id="play">
	<a href="https://open.spotify.com/album/{{ id }}">web</a>
	<a href="spotify:album:{{ id }}">spotify</a>
      </div>
    </div>
    {{/each}}
    <hr />
    </script>
</body>
</html>

